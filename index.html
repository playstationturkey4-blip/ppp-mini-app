<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Penalty Career AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: linear-gradient(#87ceeb 0%, #cfefff 45%, #7ec850 45%);
  color: #fff;
}

.screen {
  min-height: 100vh;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 20px;
}
.screen.active { display: flex; }

.card {
  width: 100%;
  max-width: 420px;
  background: rgba(15,122,46,.95);
  border-radius: 20px;
  padding: 18px;
  box-shadow: 0 30px 60px rgba(0,0,0,.45);
}

.menu-title {
  text-align: center;
  font-size: 26px;
  font-weight: 900;
  margin-bottom: 20px;
}
.menu-btn {
  width: 100%;
  padding: 16px;
  margin-top: 12px;
  font-size: 18px;
  font-weight: 800;
  border-radius: 14px;
  border: none;
  cursor: pointer;
  color: #fff;
}
.menu-btn.play { background: linear-gradient(135deg,#00c6ff,#0088cc); }
.menu-btn.career { background: linear-gradient(135deg,#1ed760,#1db954); }

.title { text-align:center;font-weight:800;font-size:22px; }
.stats { text-align:center;font-size:14px;margin:6px 0 10px; }

.stadium {
  position: relative;
  width: 100%;
  height: 230px;
  background: linear-gradient(#c0c0c0 0%, #d9d9d9 35%, #1e8f3a 35%);
  border-radius: 14px;
  overflow: hidden;
  cursor: crosshair;
}

.goal {
  position:absolute;top:42px;left:50%;
  transform:translateX(-50%);
  width:200px;height:78px;
  border:4px solid #fff;border-bottom:none;
}

.keeper {
  position:absolute;top:70px;left:50%;
  width:24px;height:36px;
  background:#ffd700;border-radius:6px;
  transform:translateX(-50%);
  transition:transform .35s ease;
}
.keeper::before {
  content:"";position:absolute;top:-14px;left:50%;
  transform:translateX(-50%);
  width:16px;height:16px;background:#ffd700;border-radius:50%;
}

.ball {
  position:absolute;bottom:20px;left:50%;
  width:22px;height:22px;
  background:#fff;border:3px solid #000;border-radius:50%;
  transform:translateX(-50%);
  transition:transform .5s ease;
}

.aim {
  position:absolute;width:14px;height:14px;
  border:2px solid red;border-radius:50%;
  pointer-events:none;display:none;
}

.power-bar { height:12px;background:#333;border-radius:6px;overflow:hidden;margin-top:10px; }
.power-fill {
  height:100%;width:0%;
  background:linear-gradient(90deg,red,orange,lime,orange,red);
}

.result { text-align:center;font-weight:700;min-height:22px;margin-top:6px; }

.btn {
  width:100%;margin-top:8px;padding:14px;
  font-size:16px;font-weight:700;border-radius:12px;
  border:none;cursor:pointer;color:#fff;display:none;
}
.btn.next { background:linear-gradient(135deg,#00c6ff,#0088cc); }
.btn.restart { background:linear-gradient(135deg,#1db954,#1ed760); }
</style>
</head>

<body>

<div class="screen active" id="menu">
  <div class="card">
    <div class="menu-title">PENALTY GAME</div>
    <button class="menu-btn play" onclick="startGame(false)">üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
    <button class="menu-btn career" onclick="startGame(true)">‚≠ê –ö–∞—Ä—å–µ—Ä–∞</button>
  </div>
</div>

<div class="screen" id="game">
  <div class="card">
    <div class="title" id="modeTitle"></div>
    <div class="stats" id="stats"></div>

    <div class="stadium" id="stadium">
      <div class="goal"></div>
      <div class="keeper" id="keeper"></div>
      <div class="ball" id="ball"></div>
      <div class="aim" id="aim"></div>
    </div>

    <div class="power-bar"><div class="power-fill" id="powerFill"></div></div>
    <div class="result" id="result">–ù–∞–≤–µ–¥–∏, –∑–∞–∂–º–∏ –∏ –±–µ–π</div>

    <button class="btn next" id="nextBtn">‚û°Ô∏è –°–ª–µ–¥—É—é—â–∏–π —É–¥–∞—Ä</button>
    <button class="btn restart" id="restartBtn">üîÅ –ù–æ–≤–∞—è —Å–µ—Ä–∏—è</button>
  </div>
</div>

<script>
let shots, goals, rating, career;
const maxShots = 5;

let shotMemory = { LT:0, LB:0, C:0, RT:0, RB:0 };

const menu = document.getElementById('menu');
const game = document.getElementById('game');
const stats = document.getElementById('stats');
const modeTitle = document.getElementById('modeTitle');
const stadium = document.getElementById('stadium');
const ball = document.getElementById('ball');
const keeper = document.getElementById('keeper');
const aim = document.getElementById('aim');
const powerFill = document.getElementById('powerFill');
const result = document.getElementById('result');
const nextBtn = document.getElementById('nextBtn');
const restartBtn = document.getElementById('restartBtn');

let power = 0, charging = false, interval, canShoot = true;

function startGame(isCareer){
  career = isCareer;
  shots = 0; goals = 0;
  shotMemory = { LT:0, LB:0, C:0, RT:0, RB:0 };

  rating = career ? Number(localStorage.getItem('rating'))||60 : 60;
  modeTitle.innerText = career ? '–ö–∞—Ä—å–µ—Ä–∞' : '–ù–æ–≤–∞—è –∏–≥—Ä–∞';
  updateStats();
  menu.classList.remove('active');
  game.classList.add('active');
}

stadium.addEventListener('mousemove',e=>{
  if(!canShoot) return;
  const r=stadium.getBoundingClientRect();
  aim.style.left=e.clientX-r.left-7+'px';
  aim.style.top=e.clientY-r.top-7+'px';
  aim.style.display='block';
});

stadium.addEventListener('mousedown',()=>{
  if(!canShoot) return;
  charging=true;power=0;powerFill.style.width='0%';
  interval=setInterval(()=>{
    power=Math.min(power+2,100);
    powerFill.style.width=power+'%';
  },30);
});

stadium.addEventListener('mouseup',e=>{
  if(!charging||!canShoot) return;
  clearInterval(interval);charging=false;canShoot=false;shots++;

  const r=stadium.getBoundingClientRect();
  const x=e.clientX-r.left, y=e.clientY-r.top;

  const zone =
    y<90 ? (x<r.width/2?'LT':'RT') :
    y<120 ? 'C' :
    (x<r.width/2?'LB':'RB');

  shotMemory[zone]++;

  const mostUsed = Object.keys(shotMemory)
    .reduce((a,b)=>shotMemory[a]>shotMemory[b]?a:b);

  const intelligence = Math.min(0.15 + rating/200, 0.6);
  const reacts = Math.random() < intelligence;

  ball.style.transform =
    `translateX(calc(-50% + ${x-r.width/2}px))
     translateY(${y-(r.height-20)}px)`;

  if(reacts && Math.random()<0.7){
    const dir = mostUsed[0]==='L'?-60:mostUsed[0]==='R'?60:0;
    keeper.style.transform=`translateX(calc(-50% + ${dir}px))`;
  }

  setTimeout(()=>{
    if(reacts && Math.random()<0.5){
      result.innerText='‚ùå –°–ï–ô–í';
    } else {
      goals++;
      if(career && rating<99) rating++;
      result.innerText='‚öΩ –ì–û–õ';
    }
    updateStats();
    showControls();
  },600);
});

function updateStats(){
  stats.innerText=`–£–¥–∞—Ä—ã: ${shots}/5 ¬∑ –ì–æ–ª—ã: ${goals} ¬∑ –†–µ–π—Ç–∏–Ω–≥: ${rating}`;
}

function showControls(){
  aim.style.display='none';powerFill.style.width='0%';
  if(shots<maxShots) nextBtn.style.display='block';
  else{
    if(career) localStorage.setItem('rating',rating);
    result.innerText=`üèÅ –°–µ—Ä–∏—è –æ–∫–æ–Ω—á–µ–Ω–∞: ${goals} –∏–∑ 5`;
    restartBtn.style.display='block';
  }
}

nextBtn.onclick=()=>{
  resetShot();nextBtn.style.display='none';
};
restartBtn.onclick=()=>{
  shots=0;goals=0;
  shotMemory={ LT:0, LB:0, C:0, RT:0, RB:0 };
  updateStats();resetShot();restartBtn.style.display='none';
};

function resetShot(){
  ball.style.transform='translateX(-50%)';
  keeper.style.transform='translateX(-50%)';
  result.innerText='–ù–∞–≤–µ–¥–∏, –∑–∞–∂–º–∏ –∏ –±–µ–π';
  canShoot=true;
}
</script>
</body>
</html>
