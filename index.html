<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Penalty Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: linear-gradient(#87ceeb 0%, #cfefff 45%, #7ec850 45%);
  color: #fff;
}

.screen {
  min-height: 100vh;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 20px;
}
.screen.active { display: flex; }

.card {
  width: 100%;
  max-width: 420px;
  background: rgba(10,90,35,0.96);
  border-radius: 22px;
  padding: 18px;
  box-shadow: 0 35px 70px rgba(0,0,0,0.5);
}

/* ===== –ú–ï–ù–Æ ===== */
.menu-title {
  text-align: center;
  font-size: 26px;
  font-weight: 900;
  margin-bottom: 20px;
}
.menu-btn {
  width: 100%;
  padding: 16px;
  margin-top: 12px;
  font-size: 18px;
  font-weight: 800;
  border-radius: 14px;
  border: none;
  cursor: pointer;
  color: #fff;
}
.menu-btn.play { background: linear-gradient(135deg,#00c6ff,#0088cc); }
.menu-btn.career { background: linear-gradient(135deg,#1ed760,#1db954); }
.menu-btn.progress { background: linear-gradient(135deg,#ffb347,#ff7f50); }
.menu-btn.records { background: linear-gradient(135deg,#ff512f,#dd2476); }

/* ===== –ò–ì–†–ê ===== */
.title { text-align:center;font-weight:800;font-size:22px; }
.stats { text-align:center;font-size:14px;margin:6px 0 10px; }

/* –°–¢–ê–î–ò–û–ù */
.stadium {
  position: relative;
  width: 100%;
  height: 230px;
  border-radius: 16px;
  overflow: hidden;
  cursor: crosshair;
  background:
    repeating-linear-gradient(
      90deg,
      #2e7d32 0px,
      #2e7d32 20px,
      #388e3c 20px,
      #388e3c 40px
    );
  box-shadow:
    inset 0 20px 40px rgba(0,0,0,0.35),
    inset 0 -20px 40px rgba(255,255,255,0.05);
}

/* –í–û–†–û–¢–ê */
.goal {
  position:absolute;
  top:42px;
  left:50%;
  transform:translateX(-50%);
  width:200px;
  height:78px;
  border:4px solid #fff;
  border-bottom:none;
  background:
    linear-gradient(
      135deg,
      rgba(255,255,255,0.18) 25%,
      transparent 25%,
      transparent 50%,
      rgba(255,255,255,0.18) 50%,
      rgba(255,255,255,0.18) 75%,
      transparent 75%
    );
  background-size: 12px 12px;
}

/* –í–†–ê–¢–ê–†–¨ */
.keeper {
  position:absolute;
  top:70px;
  left:50%;
  width:24px;
  height:36px;
  background:#ffd700;
  border-radius:6px;
  transform:translateX(-50%);
  transition:transform .35s ease;
}
.keeper::before {
  content:"";
  position:absolute;
  top:-14px;
  left:50%;
  transform:translateX(-50%);
  width:16px;
  height:16px;
  background:#ffd700;
  border-radius:50%;
}

/* –ú–Ø–ß */
.ball {
  position:absolute;
  bottom:20px;
  left:50%;
  width:22px;
  height:22px;
  background:#fff;
  border:3px solid #000;
  border-radius:50%;
  transform:translateX(-50%);
  transition:transform .5s ease;
  box-shadow: 0 8px 10px rgba(0,0,0,0.45);
}

/* –ü–†–ò–¶–ï–õ */
.aim {
  position:absolute;
  width:14px;
  height:14px;
  border:2px solid red;
  border-radius:50%;
  pointer-events:none;
  display:none;
}

/* –°–ò–õ–ê */
.power-bar {
  height:12px;
  background:#333;
  border-radius:6px;
  overflow:hidden;
  margin-top:10px;
}
.power-fill {
  height:100%;
  width:0%;
  background:linear-gradient(90deg,red,orange,lime,orange,red);
}

.result {
  text-align:center;
  font-weight:700;
  min-height:22px;
  margin-top:6px;
}

.btn {
  width:100%;
  margin-top:8px;
  padding:14px;
  font-size:16px;
  font-weight:700;
  border-radius:12px;
  border:none;
  cursor:pointer;
  display:none;
  color:#fff;
}
.btn.next { background:linear-gradient(135deg,#00c6ff,#0088cc); }
.btn.restart { background:linear-gradient(135deg,#1db954,#1ed760); }
.btn.back { background:linear-gradient(135deg,#555,#777); }

.item {
  display:flex;
  justify-content:space-between;
  margin:8px 0;
  font-size:15px;
}
</style>
</head>

<body>

<!-- –ú–ï–ù–Æ -->
<div class="screen active" id="menu">
  <div class="card">
    <div class="menu-title">PENALTY GAME</div>
    <button class="menu-btn play" onclick="startGame(false)">üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
    <button class="menu-btn career" onclick="startGame(true)">‚≠ê –ö–∞—Ä—å–µ—Ä–∞</button>
    <button class="menu-btn progress" onclick="openProgress()">üìà –ü—Ä–æ–≥—Ä–µ—Å—Å</button>
    <button class="menu-btn records" onclick="openRecords()">üèÜ –†–µ–∫–æ—Ä–¥—ã</button>
  </div>
</div>

<!-- –ò–ì–†–ê -->
<div class="screen" id="game">
  <div class="card">
    <div class="title" id="modeTitle"></div>
    <div class="stats" id="stats"></div>

    <div class="stadium" id="stadium">
      <div class="goal"></div>
      <div class="keeper" id="keeper"></div>
      <div class="ball" id="ball"></div>
      <div class="aim" id="aim"></div>
    </div>

    <div class="power-bar"><div class="power-fill" id="powerFill"></div></div>
    <div class="result" id="result">–ù–∞–≤–µ–¥–∏, –∑–∞–∂–º–∏ –∏ –±–µ–π</div>

    <button class="btn next" id="nextBtn">‚û°Ô∏è –°–ª–µ–¥—É—é—â–∏–π —É–¥–∞—Ä</button>
    <button class="btn restart" id="restartBtn">üîÅ –ù–æ–≤–∞—è —Å–µ—Ä–∏—è</button>
    <button class="btn back" id="menuBtn" onclick="backToMenu()">‚¨ÖÔ∏è –í –º–µ–Ω—é</button>
  </div>
</div>

<!-- –ü–†–û–ì–†–ï–°–° -->
<div class="screen" id="progress">
  <div class="card">
    <div class="title">–ü—Ä–æ–≥—Ä–µ—Å—Å</div>
    <div class="item"><span>–¢–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥</span><span id="pRating"></span></div>
    <div class="item"><span>–õ—É—á—à–∏–π —Ä–µ–π—Ç–∏–Ω–≥</span><span id="pBestRating"></span></div>
    <div class="item"><span>–í—Å–µ–≥–æ –≥–æ–ª–æ–≤</span><span id="pGoals"></span></div>
    <div class="item"><span>–°–µ—Ä–∏–π —Å—ã–≥—Ä–∞–Ω–æ</span><span id="pSeries"></span></div>
    <button class="btn back" style="display:block" onclick="backToMenu()">‚¨ÖÔ∏è –í –º–µ–Ω—é</button>
  </div>
</div>

<!-- –†–ï–ö–û–†–î–´ -->
<div class="screen" id="records">
  <div class="card">
    <div class="title">–†–µ–∫–æ—Ä–¥—ã</div>
    <div class="item"><span>–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</span><span id="rBestSeries"></span></div>
    <div class="item"><span>–õ—É—á—à–∏–π —Å—Ç—Ä–∏–∫</span><span id="rBestStreak"></span></div>
    <div class="item"><span>–í—Å–µ–≥–æ –≥–æ–ª–æ–≤</span><span id="rTotalGoals"></span></div>
    <button class="btn back" style="display:block" onclick="backToMenu()">‚¨ÖÔ∏è –í –º–µ–Ω—é</button>
  </div>
</div>

<script>
/* === –ü–†–û–ì–†–ï–°–° === */
function getProgress(){
  return JSON.parse(localStorage.getItem('progress')) || {
    rating:60,
    bestRating:60,
    totalGoals:0,
    seriesPlayed:0,
    bestSeries:0,
    bestStreak:0
  };
}
function saveProgress(p){
  localStorage.setItem('progress',JSON.stringify(p));
}

/* === –ò–ì–†–ê === */
let shots, goals, rating, career;
let power=0, charging=false, interval, canShoot=true;
let currentStreak=0;
const maxShots=5;

const stats=document.getElementById('stats');
const modeTitle=document.getElementById('modeTitle');
const stadium=document.getElementById('stadium');
const ball=document.getElementById('ball');
const keeper=document.getElementById('keeper');
const aim=document.getElementById('aim');
const powerFill=document.getElementById('powerFill');
const result=document.getElementById('result');
const nextBtn=document.getElementById('nextBtn');
const restartBtn=document.getElementById('restartBtn');
const menuBtn=document.getElementById('menuBtn');

function showScreen(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function startGame(isCareer){
  career=isCareer;
  shots=0; goals=0; currentStreak=0;
  const p=getProgress();
  rating=isCareer?p.rating:60;
  modeTitle.innerText=isCareer?'–ö–∞—Ä—å–µ—Ä–∞':'–ù–æ–≤–∞—è –∏–≥—Ä–∞';
  menuBtn.style.display='none';
  restartBtn.style.display='none';
  updateStats();
  resetShot();
  showScreen('game');
}

function updateStats(){
  stats.innerText=`–£–¥–∞—Ä—ã: ${shots}/5 ¬∑ –ì–æ–ª—ã: ${goals} ¬∑ –†–µ–π—Ç–∏–Ω–≥: ${rating}`;
}

stadium.addEventListener('mousemove',e=>{
  if(!canShoot) return;
  const r=stadium.getBoundingClientRect();
  aim.style.left=e.clientX-r.left-7+'px';
  aim.style.top=e.clientY-r.top-7+'px';
  aim.style.display='block';
});

stadium.addEventListener('mousedown',()=>{
  if(!canShoot) return;
  charging=true; power=0; powerFill.style.width='0%';
  interval=setInterval(()=>{
    power=Math.min(power+2,100);
    powerFill.style.width=power+'%';
  },30);
});

stadium.addEventListener('mouseup',e=>{
  if(!charging||!canShoot) return;
  clearInterval(interval); charging=false; canShoot=false;
  shots++;

  const r=stadium.getBoundingClientRect();
  const x=e.clientX-r.left;
  const y=e.clientY-r.top;

  ball.style.transform=`translateX(calc(-50% + ${x-r.width/2}px)) translateY(${y-(r.height-20)}px)`;

  const save=Math.random()<0.4;
  if(save){
    keeper.style.transform=`translateX(calc(-50% + ${x-r.width/2}px))`;
    result.innerText='‚ùå –°–ï–ô–í';
    currentStreak=0;
  }else{
    goals++; currentStreak++;
    result.innerText='‚öΩ –ì–û–õ';
    if(career && rating<99) rating++;
  }

  updateStats();
  setTimeout(afterShot,600);
});

function afterShot(){
  aim.style.display='none';
  powerFill.style.width='0%';
  if(shots<maxShots){
    nextBtn.style.display='block';
  }else{
    finishSeries();
  }
}

nextBtn.onclick=()=>{
  resetShot();
  nextBtn.style.display='none';
};

function finishSeries(){
  const p=getProgress();
  if(career){
    p.rating=rating;
    p.bestRating=Math.max(p.bestRating,rating);
    p.totalGoals+=goals;
    p.seriesPlayed++;
    p.bestSeries=Math.max(p.bestSeries,goals);
    p.bestStreak=Math.max(p.bestStreak,currentStreak);
    saveProgress(p);
  }
  result.innerText=`üèÅ –°–µ—Ä–∏—è –æ–∫–æ–Ω—á–µ–Ω–∞: ${goals} –∏–∑ 5`;
  restartBtn.style.display='block';
  menuBtn.style.display='block';
}

restartBtn.onclick=()=>{
  shots=0; goals=0; currentStreak=0;
  restartBtn.style.display='none';
  menuBtn.style.display='none';
  updateStats();
  resetShot();
};

function resetShot(){
  ball.style.transform='translateX(-50%)';
  keeper.style.transform='translateX(-50%)';
  result.innerText='–ù–∞–≤–µ–¥–∏, –∑–∞–∂–º–∏ –∏ –±–µ–π';
  canShoot=true;
}

function openProgress(){
  const p=getProgress();
  document.getElementById('pRating').innerText=p.rating;
  document.getElementById('pBestRating').innerText=p.bestRating;
  document.getElementById('pGoals').innerText=p.totalGoals;
  document.getElementById('pSeries').innerText=p.seriesPlayed;
  showScreen('progress');
}

function openRecords(){
  const p=getProgress();
  document.getElementById('rBestSeries').innerText=p.bestSeries+' / 5';
  document.getElementById('rBestStreak').innerText=p.bestStreak;
  document.getElementById('rTotalGoals').innerText=p.totalGoals;
  showScreen('records');
}

function backToMenu(){
  showScreen('menu');
}
</script>

</body>
</html>
